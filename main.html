<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test_Project</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css" >
</head>
<body>
<div id="central-panel">
    <div id="root">

    </div>
    <div id="root_2">

    </div>
</div>

<script type="text/babel">
    let map = new Map
    let massLogin = []
    class App extends React.Component{
        constructor(props) {
            super(props);

            this.state = {
                login: 'ilpanard58@gmail.com',
                password: 'Qwerty'
            };

            this.handleChange = this.handleChange.bind(this);
            this.submitData = this.submitData.bind(this);
        }

        handleChange(event) {
            const value = event.target.value
            const name = event.target.name;

            this.setState({
                [name]: value
            });
        }

        submitData(event){

            if (!map.has(this.state.login)){
                map.set(this.state.login , this.state.password)
                massLogin.push(this.state.login)
                root_2.render(<SpawnPanel />)
            }else console.log(`There is suck a key`)

            console.log(map)
            event.preventDefault();
        }
        render(){
            return(
                    <div id="log-menu">
                        <form>
                            <p>Login:<input name="login" type="text" onChange={this.handleChange} value={this.state.login}  id="inp_1"  /></p>
                            <p>Password:<input name="password" type="text" onChange={this.handleChange} value={this.state.password} id="inp_2"  /></p>
                            <button id="button-log"  onClick={this.submitData}>
                                Создать
                            </button>
                        </form>
                    </div>
            )
        }
    }

    class SpawnPanel extends React.Component{
        constructor(props) {
            super(props);
            this.state = {
                login: ' new login ',
                password: '1234'
            };

            this.changeData = this.changeData.bind(this);
        }
        deleteData(value,index){
            map.delete(value)
            massLogin.splice(index , 1)

            console.log(massLogin)
            console.log(map)
            root_2.render(<SpawnPanel />)
        }
        changeData(event){
            const value = event.target.value
            const name = event.target.name;

            this.setState({
                [name]: value
            });
        }
        buttonChange(value , index){
            if (!map.has(this.state.login)){
                massLogin.splice(index , 1,this.state.login)
                map.delete(value)
                map.set(this.state.login , this.state.password)
                root_2.render(<SpawnPanel />)
            }
        }
        empty(){}
        render() {
            return (
                <div>
                    <div id="changePanel">
                        <a id="a_change_login"> change login:</a>
                        <input name="login" id="change-login" type="text" onChange={this.changeData} value={this.state.login}/>
                        <a id="a_change_password"> change pass:</a>
                        <input name="password" id="change-password" type="text" onChange={this.changeData} value= {this.state.password}/>
                    </div>

                    {massLogin.map((log , index) =>

                        <div id="panel">
                                <p>
                                    login:
                                    <input  type="text" onChange={this.empty} value={log}/>
                                </p>
                                <p>
                                    Password:
                                    <input  type="text" onChange={this.empty} value={map.get(log)}/>
                                </p>
                                <button id="button-delete" onClick={() => this.deleteData(log , index)}>
                                    Delete
                                </button>
                                <button id="button-change" onClick={() => this.buttonChange(log , index)}>
                                    Change
                                </button>
                        </div>
                    )}
                </div>
            )
        }
    }

    const root_2 = ReactDOM.createRoot(document.getElementById('root_2'));
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App/>)
</script>

</body>
</html>

